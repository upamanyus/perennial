(* autogenerated from github.com/mit-pdos/vmvcc/tid *)
From Perennial.goose_lang Require Import prelude.
From Goose Require github_dot_com.goose_dash_lang.std.
From Goose Require github_dot_com.mit_dash_pdos.gokv.grove__ffi.
From Goose Require github_dot_com.mit_dash_pdos.vmvcc.config.

From Perennial.goose_lang Require Import ffi.grove_prelude.

Definition GenTID: val :=
  rec: "GenTID" "sid" :=
    let: "tid" := ref (zero_val uint64T) in
    "tid" <-[uint64T] (grove__ffi.GetTSC #());;
    "tid" <-[uint64T] ((((std.SumAssumeNoOverflow (![uint64T] "tid") config.N_TXN_SITES) `quot` config.N_TXN_SITES) * config.N_TXN_SITES) + "sid");;
    Skip;;
    (for: (λ: <>, (grove__ffi.GetTSC #()) ≤ (![uint64T] "tid")); (λ: <>, Skip) := λ: <>,
      Continue);;
    ![uint64T] "tid".
